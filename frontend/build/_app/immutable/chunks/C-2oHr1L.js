import"./DsnmJJEf.js";import{ag as Je,ah as Qt,aa as Xe,ai as Ye,h as Ze,l as Z,aj as Et,R as Pt,a1 as Ct,Y as $,T as ae,X as $e,_ as a,a0 as N,U as _,V as Mt,Z as o,W as S,$ as n,ak as Rt,a5 as Ot,g as v,S as Se,a4 as se}from"./trG2P9-e.js";import{a as Lt,s as M}from"./CIQPcZhh.js";import{p as Nt,i as g}from"./TCXrzA7w.js";import{e as Ie,i as je}from"./DtEgrblv.js";import{r as R,s as y}from"./BnkvbMZy.js";import{s as We}from"./DL6a1ucv.js";import{b as Fe,E as Vt}from"./CYJaQVHj.js";import{s as Ut}from"./OSfEqomL.js";import{b as Qe,g as Dt}from"./UzgXwaK6.js";function O(i,c,f=c){var l=new WeakSet;Je(i,"input",async p=>{var b=p?i.defaultValue:i.value;if(b=Ee(i)?Pe(b):b,f(b),Z!==null&&l.add(Z),await Qt(),b!==(b=c())){var q=i.selectionStart,E=i.selectionEnd,V=i.value.length;if(i.value=b??"",E!==null){var L=i.value.length;q===E&&E===V&&L>V?(i.selectionStart=L,i.selectionEnd=L):(i.selectionStart=q,i.selectionEnd=Math.min(E,L))}}}),(Ze&&i.defaultValue!==i.value||Xe(c)==null&&i.value)&&(f(Ee(i)?Pe(i.value):i.value),Z!==null&&l.add(Z)),Ye(()=>{var p=c();if(i===document.activeElement){var b=Et??Z;if(l.has(b))return}Ee(i)&&p===Pe(i.value)||i.type==="date"&&!p&&!i.value||p!==i.value&&(i.value=p??"")})}function He(i,c,f=c){Je(i,"change",l=>{var p=l?i.defaultChecked:i.checked;f(p)}),(Ze&&i.defaultChecked!==i.checked||Xe(c)==null)&&f(i.checked),Ye(()=>{var l=c();i.checked=!!l})}function Ee(i){var c=i.type;return c==="number"||c==="range"}function Pe(i){return i===""?null:+i}function At(i,c){const f={id:`q${c.questions.length+1}`,label:"",type:"text",stars:!1,required:!1},l=[...c.questions];l.splice(l.length-1,0,f),c.questions=l,c.questions=c.questions.map((p,b)=>({...p,id:`q${b+1}`}))}function Bt(i,c,f,l){if(c.questions.length===0){S(f,"Please add at least one question to preview");return}S(l,!0)}async function It(i,c,f,l,p,b){if(!c.id||!c.name||c.questions.length===0){S(f,"Please fill in all required fields and add at least one question");return}for(let q=0;q<c.questions.length;q++){const E=l(c.questions[q]);if(E){S(f,`Question ${q+1}: ${E}`);return}}S(p,!0),S(f,"");try{const q=b()?"PUT":"POST",E=b()?`${Qe}/api/templates/${c.id}`:`${Qe}/api/templates`,V=await fetch(E,{method:q,headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(V.ok)S(f,b()?"Template updated successfully!":"Template saved successfully!",!0),Ut.set(c),setTimeout(()=>{Dt(`${Qe}/templates/view`)},1500);else{const L=await V.text();S(f,`Error: ${L}`)}}catch(q){S(f,`Error saving template: ${q}`)}finally{S(p,!1)}}var jt=$('<p class="field-hint svelte-1mfyxc6">Template ID cannot be changed when editing</p>'),Wt=$('<span class="default-badge svelte-1mfyxc6">Default Rating</span>'),Ft=$('<span class="default-badge svelte-1mfyxc6">Required Comment</span>'),Ht=$('<button type="button" class="btn-danger btn-sm">‚úï</button>'),Jt=$('<div class="info-banner svelte-1mfyxc6"><span class="info-icon svelte-1mfyxc6">‚ÑπÔ∏è</span> <span>Rating-only questions display only a rating selector without a text input field.</span></div>'),Xt=$('<div class="form-group svelte-1mfyxc6"><label class="svelte-1mfyxc6"> </label> <select class="input-field svelte-1mfyxc6"><option>‚≠ê Stars</option><option>üéöÔ∏è Slider</option><option>üòä Emoji</option><option>üî¢ Numeric Buttons</option></select></div>'),Yt=$('<div class="form-row svelte-1mfyxc6"><div class="form-group svelte-1mfyxc6"><label class="svelte-1mfyxc6">Min Length</label> <input type="number" class="input-field svelte-1mfyxc6" placeholder="Minimum characters" min="0"/></div> <div class="form-group svelte-1mfyxc6"><label class="svelte-1mfyxc6">Max Length</label> <input type="number" class="input-field svelte-1mfyxc6" placeholder="Maximum characters" min="0"/></div></div>'),Zt=$('<div class="form-row svelte-1mfyxc6"><div class="form-group svelte-1mfyxc6"><label class="svelte-1mfyxc6">Min Value</label> <input type="number" class="input-field svelte-1mfyxc6" placeholder="Minimum value"/></div> <div class="form-group svelte-1mfyxc6"><label class="svelte-1mfyxc6">Max Value</label> <input type="number" class="input-field svelte-1mfyxc6" placeholder="Maximum value"/></div></div>'),zt=$('<div class="option-row svelte-1mfyxc6"><input type="text" class="input-field svelte-1mfyxc6"/> <button type="button" class="btn-danger btn-sm">‚úï</button></div>'),Gt=$('<div class="options-section svelte-1mfyxc6"><div class="section-header svelte-1mfyxc6"><h4 class="svelte-1mfyxc6">Options</h4> <button type="button" class="btn-info btn-sm">+ Add Option</button></div> <!></div>'),Kt=$('<div><div class="question-header svelte-1mfyxc6"><span class="question-number svelte-1mfyxc6"> <!></span> <!></div> <div class="form-group svelte-1mfyxc6"><label class="svelte-1mfyxc6"> </label> <input type="text" class="input-field svelte-1mfyxc6" placeholder="Enter your question" required/></div> <div class="form-row svelte-1mfyxc6"><div class="form-group svelte-1mfyxc6"><label class="svelte-1mfyxc6"> </label> <select class="input-field svelte-1mfyxc6"><option>Text</option><option>Multiline Text</option><option>Select</option><option>Number</option><option>‚≠ê Rating Only (No Text Field)</option></select></div> <div class="form-group svelte-1mfyxc6"><label class="checkbox-label svelte-1mfyxc6"><input type="checkbox"/> Include Rating <!></label></div></div> <!> <!> <div class="validation-section svelte-1mfyxc6"><h4 class="svelte-1mfyxc6">Validation Rules</h4> <div class="form-row svelte-1mfyxc6"><div class="form-group svelte-1mfyxc6"><label class="checkbox-label svelte-1mfyxc6"><input type="checkbox"/> </label></div></div> <!> <!></div> <!></div>'),ea=$("<div> </div>"),ta=(i,c)=>i.key==="Escape"&&c(),aa=i=>i.stopPropagation(),sa=$('<p class="modal-description-text svelte-1mfyxc6"> </p>'),la=$(`<div class="modal-overlay svelte-1mfyxc6" role="presentation" tabindex="-1"><div class="modal-content card preview-modal svelte-1mfyxc6" role="dialog" aria-modal="true" tabindex="-1"><div class="modal-header svelte-1mfyxc6"><div><h2 class="svelte-1mfyxc6">Template Preview</h2> <p class="modal-subtitle svelte-1mfyxc6"> </p> <!></div> <button class="btn-close svelte-1mfyxc6">‚úï</button></div> <div class="modal-body svelte-1mfyxc6"><div class="preview-notice svelte-1mfyxc6"><span class="notice-icon svelte-1mfyxc6">‚ÑπÔ∏è</span> <span>This is a preview. Submissions won't be saved.</span></div> <!></div></div></div>`),ia=$('<div class="template-creator svelte-1mfyxc6"><div class="header-section svelte-1mfyxc6"><h2 class="svelte-1mfyxc6"> </h2> <button type="button" class="btn-info">Preview Template</button></div> <div class="form-group svelte-1mfyxc6"><label for="template-id" class="svelte-1mfyxc6">Template ID *</label> <input id="template-id" type="text" class="input-field svelte-1mfyxc6" placeholder="e.g., user-satisfaction" required/> <!></div> <div class="form-group svelte-1mfyxc6"><label for="template-name" class="svelte-1mfyxc6">Template Name *</label> <input id="template-name" type="text" class="input-field svelte-1mfyxc6" placeholder="e.g., User Satisfaction Survey" required/></div> <div class="form-group svelte-1mfyxc6"><label for="template-desc" class="svelte-1mfyxc6">Description</label> <textarea id="template-desc" class="input-field svelte-1mfyxc6" placeholder="Brief description of the template" rows="3"></textarea></div> <div class="questions-section svelte-1mfyxc6"><h3 class="svelte-1mfyxc6">Questions</h3> <!> <button type="button" class="btn-success btn-full">+ Add Question</button> <p class="add-question-hint svelte-1mfyxc6">New questions will be added before "Additional comments"</p></div> <button type="button" class="btn-primary btn-full"><!></button> <!></div> <!>',1);function _a(i,c){Pt(c,!0);let f=Nt(c,"isEditMode",3,!1),l=Ct(c.initialTemplate||{id:"",name:"",description:"",questions:[{id:"q1",label:"How do you feel about this session?",type:"none",stars:!0,starType:"emoji",required:!0},{id:"q2",label:"Additional comments",type:"textarea",stars:!1,required:!0}]}),p=$e(""),b=$e(!1),q=$e(!1);function E(s){const e=l.questions.length;if(s===0){S(p,"Cannot remove the default session rating question");return}if(s===e-1){S(p,"Cannot remove the required additional comments question");return}l.questions=l.questions.filter((t,w)=>w!==s),l.questions=l.questions.map((t,w)=>({...t,id:`q${w+1}`}))}function V(s){const e=l.questions[s];e.options||(e.options=[]),e.options=[...e.options,""],l.questions=[...l.questions]}function L(s,e){const t=l.questions[s];t.options&&(t.options=t.options.filter((w,C)=>C!==e),l.questions=[...l.questions])}function ze(s){const e=l.questions[s];e.stars&&!e.starType&&(e.starType="slider"),l.questions=[...l.questions]}function Ge(s){const e=l.questions[s];e.type==="none"&&(e.stars=!0,e.starType||(e.starType="slider")),l.questions=[...l.questions]}function Ke(s){return s.type==="none"&&!s.stars?"Rating-only questions must have a rating type selected":s.type==="select"&&(!s.options||s.options.length===0)?"Select questions must have at least one option":!s.label||s.label.trim()===""?"Question label is required":null}function le(){S(q,!1)}function et(s){console.log("Preview responses:",s),alert("Preview submission successful! (This is just a preview - no data was saved)")}function P(s){return s===0||s===l.questions.length-1}var Ce=ia(),ie=ae(Ce),re=o(ie),oe=o(re),tt=o(oe,!0);n(oe);var at=a(oe,2);at.__click=[Bt,l,p,q],n(re);var ne=a(re,2),z=a(o(ne),2);R(z);var st=a(z,2);{var lt=s=>{var e=jt();_(s,e)};g(st,s=>{f()&&s(lt)})}n(ne);var ve=a(ne,2),Me=a(o(ve),2);R(Me),n(ve);var ce=a(ve,2),Re=a(o(ce),2);Rt(Re),n(ce);var de=a(ce,2),Oe=a(o(de),2);Ie(Oe,17,()=>l.questions,je,(s,e,t)=>{var w=Kt();let C;var U=o(w),W=o(U),G=o(W);G.nodeValue=`Question ${t+1} `;var ue=a(G);{var fe=r=>{var d=Wt();_(r,d)},K=r=>{var d=Se(),m=ae(d);{var k=u=>{var x=Ft();_(u,x)};g(m,u=>{t===l.questions.length-1&&u(k)},!0)}_(r,d)};g(ue,r=>{t===0?r(fe):r(K,!1)})}n(W);var pe=a(W,2);{var F=r=>{var d=Ht();d.__click=()=>E(t),_(r,d)};g(pe,r=>{P(t)||r(F)})}n(U);var D=a(U,2),A=o(D);y(A,"for",`question-label-${t}`);var ft=o(A);n(A);var ee=a(A,2);R(ee),y(ee,"id",`question-label-${t}`),n(D);var me=a(D,2),_e=o(me),te=o(_e);y(te,"for",`question-type-${t}`);var pt=o(te);n(te);var B=a(te,2);y(B,"id",`question-type-${t}`),B.__change=()=>Ge(t);var ye=o(B);ye.value=ye.__value="text";var be=a(ye);be.value=be.__value="textarea";var xe=a(be);xe.value=xe.__value="select";var he=a(xe);he.value=he.__value="number";var Le=a(he);Le.value=Le.__value="none",n(B),n(_e);var Ne=a(_e,2),ge=o(Ne);y(ge,"for",`question-stars-${t}`);var I=o(ge);R(I),y(I,"id",`question-stars-${t}`),I.__change=()=>ze(t);var mt=a(I,2);{var _t=r=>{var d=se("(always on)");_(r,d)},yt=r=>{var d=Se(),m=ae(d);{var k=u=>{var x=se("(required for rating-only)");_(u,x)};g(m,u=>{v(e).type==="none"&&u(k)},!0)}_(r,d)};g(mt,r=>{t===0?r(_t):r(yt,!1)})}n(ge),n(Ne),n(me);var Ve=a(me,2);{var bt=r=>{var d=Jt();_(r,d)};g(Ve,r=>{v(e).type==="none"&&r(bt)})}var Ue=a(Ve,2);{var xt=r=>{var d=Xt(),m=o(d);y(m,"for",`question-star-type-${t}`);var k=o(m);n(m);var u=a(m,2);y(u,"id",`question-star-type-${t}`);var x=o(u);x.value=x.__value="stars";var T=a(x);T.value=T.__value="slider";var h=a(T);h.value=h.__value="emoji";var Q=a(h);Q.value=Q.__value="numeric",n(u),n(d),N((J,Be)=>{M(k,`Rating Type ${J??""}`),u.disabled=Be},[()=>P(t)?"(locked)":"*",()=>P(t)]),Fe(u,()=>v(e).starType,J=>v(e).starType=J),_(r,d)};g(Ue,r=>{v(e).stars&&r(xt)})}var qe=a(Ue,2),we=a(o(qe),2),De=o(we),ke=o(De);y(ke,"for",`question-required-${t}`);var H=o(ke);R(H),y(H,"id",`question-required-${t}`);var ht=a(H);n(ke),n(De),n(we);var Ae=a(we,2);{var gt=r=>{var d=Yt(),m=o(d),k=o(m);y(k,"for",`question-min-length-${t}`);var u=a(k,2);R(u),y(u,"id",`question-min-length-${t}`),n(m);var x=a(m,2),T=o(x);y(T,"for",`question-max-length-${t}`);var h=a(T,2);R(h),y(h,"id",`question-max-length-${t}`),n(x),n(d),O(u,()=>v(e).minLength,Q=>v(e).minLength=Q),O(h,()=>v(e).maxLength,Q=>v(e).maxLength=Q),_(r,d)};g(Ae,r=>{(v(e).type==="text"||v(e).type==="textarea")&&!v(e).stars&&r(gt)})}var qt=a(Ae,2);{var wt=r=>{var d=Zt(),m=o(d),k=o(m);y(k,"for",`question-min-${t}`);var u=a(k,2);R(u),y(u,"id",`question-min-${t}`),n(m);var x=a(m,2),T=o(x);y(T,"for",`question-max-${t}`);var h=a(T,2);R(h),y(h,"id",`question-max-${t}`),n(x),n(d),O(u,()=>v(e).min,Q=>v(e).min=Q),O(h,()=>v(e).max,Q=>v(e).max=Q),_(r,d)};g(qt,r=>{v(e).type==="number"&&r(wt)})}n(qe);var kt=a(qe,2);{var Tt=r=>{var d=Gt(),m=o(d),k=a(o(m),2);k.__click=()=>V(t),n(m);var u=a(m,2);{var x=T=>{var h=Se(),Q=ae(h);Ie(Q,17,()=>v(e).options,je,(J,Be,X)=>{var Te=zt(),Y=o(Te);R(Y),y(Y,"id",`question-${t}-option-${X}`),y(Y,"placeholder",`Option ${X+1}`);var $t=a(Y,2);$t.__click=()=>L(t,X),n(Te),O(Y,()=>v(e).options[X],St=>v(e).options[X]=St),_(J,Te)}),_(T,h)};g(u,T=>{v(e).options&&T(x)})}n(d),_(r,d)};g(kt,r=>{v(e).type==="select"&&r(Tt)})}n(w),N((r,d,m,k,u,x,T,h)=>{C=We(w,1,"card question-card svelte-1mfyxc6",null,C,r),M(ft,`Question Label ${d??""}`),ee.disabled=m,M(pt,`Question Type ${k??""}`),B.disabled=u,I.disabled=x,H.disabled=T,M(ht,` Required ${h??""}`)},[()=>({"default-question":P(t)}),()=>P(t)?"(locked)":"*",()=>P(t),()=>P(t)?"(locked)":"*",()=>P(t),()=>P(t)||v(e).type==="none",()=>P(t),()=>P(t)?"(always required)":""]),O(ee,()=>v(e).label,r=>v(e).label=r),Fe(B,()=>v(e).type,r=>v(e).type=r),He(I,()=>v(e).stars,r=>v(e).stars=r),He(H,()=>v(e).required,r=>v(e).required=r),_(s,w)});var it=a(Oe,2);it.__click=[At,l],Ot(2),n(de);var j=a(de,2);j.__click=[It,l,p,Ke,b,f];var rt=o(j);{var ot=s=>{var e=se();N(()=>M(e,f()?"Updating...":"Saving...")),_(s,e)},nt=s=>{var e=se();N(()=>M(e,f()?"Update Template":"Save Template")),_(s,e)};g(rt,s=>{v(b)?s(ot):s(nt,!1)})}n(j);var vt=a(j,2);{var ct=s=>{var e=ea();let t;var w=o(e,!0);n(e),N(C=>{t=We(e,1,"message",null,t,C),M(w,v(p))},[()=>({"message-success":v(p).includes("success"),"message-error":!v(p).includes("success")})]),_(s,e)};g(vt,s=>{v(p)&&s(ct)})}n(ie);var dt=a(ie,2);{var ut=s=>{var e=la();e.__click=le,e.__keydown=[ta,le];var t=o(e);t.__click=[aa];var w=o(t),C=o(w),U=a(o(C),2),W=o(U,!0);n(U);var G=a(U,2);{var ue=F=>{var D=sa(),A=o(D,!0);n(D),N(()=>M(A,l.description)),_(F,D)};g(G,F=>{l.description&&F(ue)})}n(C);var fe=a(C,2);fe.__click=le,n(w);var K=a(w,2),pe=a(o(K),2);Vt(pe,{get template(){return l.questions},handleSubmit:et}),n(K),n(t),n(e),N(()=>M(W,l.name||"Untitled Template")),_(s,e)};g(dt,s=>{v(q)&&s(ut)})}N(()=>{M(tt,f()?"Edit Template":"Create New Template"),z.disabled=f(),j.disabled=v(b)}),O(z,()=>l.id,s=>l.id=s),O(Me,()=>l.name,s=>l.name=s),O(Re,()=>l.description,s=>l.description=s),_(i,Ce),Mt()}Lt(["click","change","keydown"]);export{_a as C};
